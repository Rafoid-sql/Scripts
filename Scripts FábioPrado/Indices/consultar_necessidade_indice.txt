-- Verificar necessidade de indice

SELECT CS.COLUMN_NAME,
CS.NUM_DISTINCT,
CS.NUM_NULLS,
CS.NUM_BUCKETS,
CS.DENSITY,
(SELECT NUM_ROWS
FROM DBA_TABLES T
WHERE T.TABLE_NAME = ACAO_MKT_LOG
AND   T.OWNER = DBAASS) AS TOT_LINHAS,
((CS.NUM_DISTINCT * 100) /
(SELECT NUM_ROWS
FROM DBA_TABLES T
WHERE T.TABLE_NAME = ACAO_MKT_LOG
AND T.OWNER = DBAASS)) as "% total"
FROM DBA_TAB_COL_STATISTICS CS
WHERE CS.TABLE_NAME = 'ACAO_MKT_LOG'
ORDER BY CS.COLUMN_NAME;